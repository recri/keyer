#!/usr/bin/R

#
# compute a quadratic approximation to the power meter calibration table
# that quisk uses to compute forward and reverse power from raw ADC measurements
#
data <- c(0, 0.0, 
	  25.865384615384617, 0.0025502539351328003,
	  101.02453987730061, 0.012752044999999998,
	  265.2901234567901, 0.050600930690879994,
	  647.9155844155844, 0.21645831264800003,
	  1196.5935483870967, 0.66548046472992,
	  1603.7032258064517, 1.1557229391679997,
	  2012.3271604938273, 1.811892166688,
	  2616.7727272727275, 3.0085848760319993,
          3173.818181818182, 4.3927428485119995,
	  3382.7922077922076, 4.9791328857920005, 
	  3721.0714285714284, 6.024750791808321,
          4093.1785714285716, 7.28994845808807,
	  4502.496428571429, 8.820837634286566,
	  4952.746071428572, 10.673213537486745)

x <- data[seq(1, 30, 2)]
y <- data[seq(2, 30, 2)]

plot(x,y)
model <- lm(y ~ 1+x+I(x^2))
summary(model)
lines(x, predict(model))

# the data for an earlier table
# it's another parabola, but different
data2 <- c(0, 0.0, 9.07, 0.002, 54.98, 0.014, 148.6, 0.057, 328.0, 0.208, 611.1, 0.646, 807.0, 1.098, 982.1, 1.6, 1223.3, 2.471, 1517.7, 3.738, 1758.7, 5.02)
x2 <- data2[seq(1, 22, 2)]
y2 <- data2[seq(2, 22, 2)]

lines(x2, predict(model2))