if {[lsearch [namespace children] ::tcltest] == -1} {
    package require tcltest 2
    namespace import -force ::tcltest::*
}

package require dbus-tcl
dbus connect
set me [dbus info name]

test return-1.1 {simple return} -body {
    dbus return $me 42
} -result {^\d+$} -match regexp

test return-1.2 {simple with args} -body {
    dbus return $me 42 foo 99
} -result {^\d+$} -match regexp

test return-1.3 {simple with signature} -body {
    dbus return -signature si $me 42 foo 99
} -result {^\d+$} -match regexp

test return-1.4 {return with invalid destination} -body {
    dbus return -signature 42
} -returnCodes error -result {Invalid destination}

test return-1.5 {return with invalid destination} -body {
    dbus return $me foo
} -returnCodes error -result {Invalid serial}

# cleanup
cleanupTests
return
